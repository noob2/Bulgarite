<div ng-controller="topicPageController">

    <div id="topic">
        <h2>{{topic.header}}</h2>
        <p>{{topic.author}}</p>
        <p>{{topic._kmd.lmt}}</p>
        <p>{{topic.text}}</p>
        <button ng-click="removeTopic(topic._id)" ng-if="userID === topic._acl.creator" class="remove-button">Изтрий темата</button>
    </div>

    <div ng-repeat="comment in comments">

        <div class="comment">

            <p>{{comment.author}}</p>
            <p>{{comment._kmd.lmt}}</p>
            <button ng-if="isLoggedIn" ng-click="deleteComment(comment._id)" class="remove-button">Изтрий коментара</button>
            <button ng-if="isLoggedIn" ng-click="showReOptions(comment._id)" class="add-button">Коментирай</button>
            <p>{{comment.text}}</p>

            <div ng-if="showReOptionsID == comment._id" class="add-comment">

                <textarea ng-model="reComment.text"></textarea>
                <button ng-click="addReComment(reComment)">Добави коментар</button>

            </div>

        </div>

        <div ng-repeat="reComment in comment.reComments" class="re-comment">

            <p>{{reComment.author}}</p>
            <p>{{reComment._kmd.lmt}}</p>
            <p>{{reComment.text}}</p>
            <button ng-if="isLoggedIn" ng-click="deleteComment(reComment._id)" class="remove-button">Изтрий отговора</button>
        </div>

    </div>

    <button ng-if="isLoggedIn && !showOptions" ng-click="showAddCommentOptions()" class="add-button">Добави коментар
    </button>

    <div ng-if="showOptions" class="add-comment">
        <textarea ng-model="comment.text"></textarea>
        <button ng-click="addComment(comment)">Добави коментар</button>
    </div>

</div>
